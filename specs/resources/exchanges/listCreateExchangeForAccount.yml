get:
  tags:
    - exchanges
  summary: List exchanges for an account
  description: List exchanges for an account
  operationId: listAccountExchanges
  x-speakeasy-group: accounts.exchanges
  x-speakeasy-name-override: list
  x-codeSamples:
    - lang: bash
      source: |
        GET https://api.dwolla.com/exchanges
        Accept: application/vnd.dwolla.v1.hal+json
        Authorization: Bearer pBA9fVDBEyYZCEsLf/wKehyh1RTpzjUj5KzIRfDi0wKTii7DqY

        ...

        {
            "_links": {
                "self": {
                    "href": "https://api.dwolla.com/exchanges",
                    "type": "application/vnd.dwolla.v1.hal+json",
                    "resource-type": "exchange"
                }
            },
            "_embedded": {
                "exchanges": [
                    {
                        "_links": {
                            "self": {
                                "href": "https://api-sandbox.dwolla.com/exchanges/3dad9cbf-9cb6-4efb-8a17-53d7199a0fee",
                                "type": "application/vnd.dwolla.v1.hal+json",
                                "resource-type": "exchange"
                            },
                            "exchange-partner": {
                                "href": "https://api-sandbox.dwolla.com/exchange-partners/9b55a4b3-34ae-4607-b2d1-622f1eed77f9",
                                "type": "application/vnd.dwolla.v1.hal+json",
                                "resource-type": "exchange-partner"
                            },
                            "account": {
                                "href": "https://api-sandbox.dwolla.com/accounts/80764434-5391-4c6e-89fa-2f96662e9a3a",
                                "type": "application/vnd.dwolla.v1.hal+json",
                                "resource-type": "account"
                            }
                        },
                        "id": "3dad9cbf-9cb6-4efb-8a17-53d7199a0fee",
                        "status": "active",
                        "created": "2022-05-23T16:33:30.450Z"
                    },
                    {
                        "_links": {
                            "self": {
                                "href": "https://api-sandbox.dwolla.com/exchanges/cfd39dd1-76fa-4040-86cc-77aabd0aa9e1",
                                "type": "application/vnd.dwolla.v1.hal+json",
                                "resource-type": "exchange"
                            },
                            "exchange-partner": {
                                "href": "https://api-sandbox.dwolla.com/exchange-partners/9b55a4b3-34ae-4607-b2d1-622f1eed77f9",
                                "type": "application/vnd.dwolla.v1.hal+json",
                                "resource-type": "exchange-partner"
                            },
                            "account": {
                                "href": "https://api-sandbox.dwolla.com/accounts/80764434-5391-4c6e-89fa-2f96662e9a3a",
                                "type": "application/vnd.dwolla.v1.hal+json",
                                "resource-type": "account"
                            }
                        },
                        "id": "cfd39dd1-76fa-4040-86cc-77aabd0aa9e1",
                        "status": "active",
                        "created": "2022-05-23T16:28:02.965Z"
                    }
                ]
            },
            "total": 2
        }
    - lang: javascript
      source: |
        // Using dwolla-v2 - https://github.com/Dwolla/dwolla-v2-node
        token.get("exchanges").then((res) => res.body._embedded["exchanges"][0].id); // => '56502f7a-fa59-4a2f-8579-0f8bc9d7b9cc'
    - lang: python
      source: |
        # Using dwollav2 - https://github.com/Dwolla/dwolla-v2-python
        exchanges = app_token.get('exchanges')
        exchanges.body['_embedded']['exchanges'][0]['id'] # => '56502f7a-fa59-4a2f-8579-0f8bc9d7b9cc'
    - lang: php
      source: |
        <?php
        // Using dwollaswagger - https://github.com/Dwolla/dwolla-swagger-php
        $exchangesApi = new ExchangesApi($apiClient);

        $exchanges = $exchangesApi->getAccountExchanges();
        $exchanges->_embedded->{"exchanges"}[0]->id; # => "56502f7a-fa59-4a2f-8579-0f8bc9d7b9cc"
        ?>
    - lang: ruby
      source: |
        # Using dwolla_v2 - https://github.com/Dwolla/dwolla-v2-ruby
        exchanges = app_token.get "exchanges"
        exchanges._embedded['exchanges'][0].id # => "56502f7a-fa59-4a2f-8579-0f8bc9d7b9cc"
  parameters:
    - $ref: '../../schemas/common.yml#/components/parameters/Accept'
  responses:
    '200':
      description: successful operation
      headers: {}
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            $ref: '../../schemas/exchanges/Exchanges.yml#/Exchanges'
    '403':
      description: Forbidden
      headers: {}
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            $ref: '../../schemas/common.yml#/components/schemas/ForbiddenError'
    '404':
      description: Not Found
      headers: {}
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            $ref: '../../schemas/common.yml#/components/schemas/NotFoundError'
post:
  tags:
    - exchanges
  summary: Create an exchange for an account
  description: |
    Create an exchange for an account. The request body will vary based on the exchange partner.
    For Finicity, the request body will include finicity-specific fields.
    For MX Secure Exchange, the request body will include a token.
    For Flinks Secure Exchange, the request body will include a token.
    For Plaid Secure Exchange, the request body will include a token.
  operationId: createAccountExchange
  x-speakeasy-group: accounts.exchanges
  x-speakeasy-name-override: create
  x-codeSamples:
    - lang: bash
      source: |
        POST https://api.dwolla.com/exchanges
        Accept: application/vnd.dwolla.v1.hal+json
        Content-Type: application/vnd.dwolla.v1.hal+json
        Authorization: Bearer pBA9fVDBEyYZCEsLf/wKehyh1RTpzjUj5KzIRfDi0wKTii7DqY

        {
            "_links": {
                "exchange-partner": {
                    "href": "https://api.dwolla.com/exchange-partners/f53ffb32-c84f-496a-9d9d-acd100d396ef"
                }
            },
            "token": "somePlaidProcessorToken"
        }

        HTTP/1.1 201 Created
        Location: https://api.dwolla.com/exchanges/fcd15e5f-8d13-4570-a9b7-7fb49e55941d
    - lang: javascript
      source: |
        // Using dwolla-v2 - https://github.com/Dwolla/dwolla-v2-node
        var requestBody = {
          _links: {
            "exchange-partner": {
              href: "https://api.dwolla.com/exchange-partners/f53ffb32-c84f-496a-9d9d-acd100d396ef",
            },
          },
          token: "somePlaidProcessorToken",
        };

        dwolla
          .post("exchanges", requestBody)
          .then((res) => res.headers.get("location")); // => 'https://api.dwolla.com/exchanges/fcd15e5f-8d13-4570-a9b7-7fb49e55941d'
    - lang: python
      source: |
        # Using dwollav2 - https://github.com/Dwolla/dwolla-v2-python
        request_body = {
          '_links': {
            'exchange-partner': {
              'href': 'https://api.dwolla.com/exchange-partners/f53ffb32-c84f-496a-9d9d-acd100d396ef'
            }
          },
          'token': 'somePlaidProcessorToken'
        }

        exchange = app_token.post('exchange', request_body)
        exchange.headers['location'] # => 'https://api.dwolla.com/exchanges/fcd15e5f-8d13-4570-a9b7-7fb49e55941d'
    - lang: php
      source: |
        <?php
        // Using dwollaswagger - https://github.com/Dwolla/dwolla-swagger-php
        $exchangesApi = new ExchangesApi($apiClient);

        $exchange = $exchangesApi->createAccountExchange(new CreateExchangeRequest([
            "_links" => [
                "exchange-partner" => [
                    "href" => "https://api.dwolla.com/exchange-partners/f53ffb32-c84f-496a-9d9d-acd100d396ef"
                ]
            ],
            "token" => "somePlaidProcessorToken"
        ]));

        $exchange; # => https://api.dwolla.com/exchanges/fcd15e5f-8d13-4570-a9b7-7fb49e55941d
        ?>
    - lang: ruby
      source: |
        # Using dwolla_v2 - https://github.com/Dwolla/dwolla-v2-ruby
        request_body = {
          _links: {
            'exchange-partner': {
              href: "https://api.dwolla.com/exchange-partners/f53ffb32-c84f-496a-9d9d-acd100d396ef"
            }
          },
          token: 'somePlaidProcessorToken'
        }

        exchange = app_token.post "exchanges", request_body
        exchange.response_headers[:location] # => "https://api.dwolla.com/exchanges/fcd15e5f-8d13-4570-a9b7-7fb49e55941d"
  parameters:
    - $ref: '../../schemas/common.yml#/components/parameters/Accept'
  responses:
    '201':
      description: Created
      headers:
        Location:
          $ref: '../../schemas/common.yml#/components/headers/Location'
          example: https://api.dwolla.com/exchanges/fcd15e5f-8d13-4570-a9b7-7fb49e55941d
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            type: object
    '400':
      description: Bad Request
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            oneOf:
              - $ref: '../../schemas/exchanges/CreateExchange.yml#/InvalidExchangeToken'
              - $ref: '../../schemas/exchanges/CreateExchange.yml#/InvalidExchange'
    '401':
      description: Invalid Scope
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            type: object
            properties:
              code:
                type: string
                example: InvalidExchange
              message:
                type: string
                example: The exchange is no longer active.
    '403':
      description: Forbidden
      headers: {}
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            $ref: '../../schemas/common.yml#/components/schemas/ForbiddenError'
    '404':
      description: Not Found
      headers: {}
      content:
        application/vnd.dwolla.v1.hal+json:
          schema:
            $ref: '../../schemas/common.yml#/components/schemas/NotFoundError'
